   56.702903] ==================================================================
[   56.703737] BUG: KASAN: slab-out-of-bounds in nft_set_elem_init.cold+0x123/0x1b3
[   56.704590] Write of size 34 at addr ffff8880064964b0 by task poc/1614
[   56.705380] 
[   56.705550] CPU: 0 PID: 1614 Comm: poc Tainted: G        W         5.15.0-detector-kasan #1
[   56.706699] Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.15.0-1 04/01/2014
[   56.707833] Call Trace:
[   56.708217]  dump_stack_lvl+0x34/0x44
[   56.708810]  print_address_description.constprop.0+0x21/0x140
[   56.709634]  ? nft_set_elem_init.cold+0x123/0x1b3
[   56.710230]  ? nft_set_elem_init.cold+0x123/0x1b3
[   56.710767]  kasan_report.cold+0x83/0xdf
[   56.711230]  ? kasan_unpoison+0x21/0x50
[   56.711690]  ? nft_set_elem_init.cold+0x123/0x1b3
[   56.712213]  kasan_check_range+0x14e/0x1b0
[   56.712632]  memcpy+0x39/0x60
[   56.712953]  nft_set_elem_init.cold+0x123/0x1b3
[   56.713489]  nft_add_set_elem+0xc4f/0x15d0
[   56.714125]  ? nf_tables_delsetelem+0x3f0/0x3f0
[   56.714789]  ? is_bpf_text_address+0x13/0x20
[   56.715281]  ? kernel_text_address+0xf3/0x100
[   56.715720]  ? __kernel_text_address+0xe/0x30
[   56.716139]  ? unwind_get_return_address+0x2f/0x50
[   56.716649]  ? arch_stack_walk+0x9e/0xf0
[   56.717128]  ? stack_trace_save+0x91/0xc0
[   56.717705]  ? stack_trace_snprint+0xb0/0xb0
[   56.718315]  ? stack_trace_snprint+0xb0/0xb0
[   56.718781]  ? kasan_save_stack+0x32/0x40
[   56.719194]  ? kasan_save_stack+0x1b/0x40
[   56.719606]  ? __kasan_slab_alloc+0x61/0x80
[   56.720048]  ? netlink_unicast+0x2d8/0x3d0
[   56.720640]  ? netlink_sendmsg+0x398/0x680
[   56.721227]  ? sock_sendmsg+0x96/0xa0
[   56.721805]  ? ____sys_sendmsg+0x347/0x3e0
[   56.722373]  ? ___sys_sendmsg+0xe0/0x140
[   56.723032]  ? __sys_sendmsg+0xb3/0x130
[   56.724250]  ? do_syscall_64+0x3b/0x90
[   56.725401]  ? entry_SYSCALL_64_after_hwframe+0x44/0xae
[   56.726789]  ? do_syscall_64+0x3b/0x90
[   56.727603]  ? entry_SYSCALL_64_after_hwframe+0x44/0xae
[   56.728667]  ? stack_access_ok+0x3a/0x90
[   56.729750]  ? strlen+0x1f/0x40
[   56.730554]  ? nla_strcmp+0x47/0x80
[   56.731551]  ? memcmp+0x41/0xa0
[   56.732332]  ? nft_set_lookup+0x62/0xb0
[   56.733312]  nf_tables_newsetelem+0x372/0x410
[   56.734375]  ? nft_add_set_elem+0x15d0/0x15d0
[   56.735416]  ? __mutex_unlock_slowpath.isra.0+0x210/0x210
[   56.736678]  nfnetlink_rcv_batch+0x7b9/0xad0
[   56.737746]  ? nfnetlink_net_init+0x130/0x130
[   56.738666]  ? __alloc_skb+0x19b/0x230
[   56.739341]  ? kasan_save_stack+0x1b/0x40
[   56.739941]  ? __kasan_slab_alloc+0x61/0x80
[   56.740564]  ? kmem_cache_alloc_node+0xe0/0x210
[   56.741245]  ? __alloc_skb+0x19b/0x230
[   56.741801]  ? memset+0x20/0x40
[   56.742239]  ? __nla_validate_parse+0xac/0x1190
[   56.742699]  ? entry_SYSCALL_64_after_hwframe+0x44/0xae
[   56.743216]  ? apparmor_capable+0xfd/0x2a0
[   56.743654]  ? apparmor_file_free_security+0x80/0x80
[   56.744307]  ? nla_get_range_signed+0x1c0/0x1c0
[   56.744920]  ? is_bpf_text_address+0x13/0x20
[   56.745535]  ? bpf_lsm_capset+0x10/0x10
[   56.746192]  nfnetlink_rcv+0x1bb/0x1f0
[   56.746797]  ? nfnetlink_rcv_batch+0xad0/0xad0
[   56.747491]  netlink_unicast+0x2d8/0x3d0
[   56.748091]  ? netlink_attachskb+0x400/0x400
[   56.748730]  ? unwind_next_frame+0x8ca/0x960
[   56.749365]  ? entry_SYSCALL_64_after_hwframe+0x44/0xae
[   56.750130]  netlink_sendmsg+0x398/0x680
[   56.750684]  ? netlink_unicast+0x3d0/0x3d0
[   56.751253]  ? iovec_from_user+0x12e/0x1a0
[   56.751826]  ? netlink_unicast+0x3d0/0x3d0
[   56.752368]  sock_sendmsg+0x96/0xa0
[   56.752838]  ____sys_sendmsg+0x347/0x3e0
[   56.753368]  ? kernel_sendmsg+0x30/0x30
[   56.753896]  ? __copy_msghdr_from_user+0x250/0x250
[   56.754533]  ? _raw_spin_lock+0x7a/0xd0
[   56.755037]  ? __x64_sys_add_key+0x1d2/0x2a0
[   56.755619]  ? kasan_save_stack+0x32/0x40
[   56.756155]  ? kasan_save_stack+0x1b/0x40
[   56.756685]  ? kasan_set_track+0x1c/0x30
[   56.757212]  ___sys_sendmsg+0xe0/0x140
[   56.757714]  ? sendmsg_copy_msghdr+0x30/0x30
[   56.758280]  ? key_create_or_update+0x198/0x670
[   56.758884]  ? key_type_lookup+0x90/0x90
[   56.759409]  ? join_session_keyring+0x1a0/0x1a0
[   56.760008]  ? strndup_user+0x47/0x70
[   56.760509]  ? __fget_light+0x9e/0xf0
[   56.761001]  __sys_sendmsg+0xb3/0x130
[   56.761496]  ? __sys_sendmsg_sock+0x20/0x20
[   56.762054]  ? kfree+0x90/0x220
[   56.762503]  ? fpregs_assert_state_consistent+0x52/0x60
[   56.763219]  ? exit_to_user_mode_prepare+0x35/0x150
[   56.763913]  do_syscall_64+0x3b/0x90
[   56.764458]  entry_SYSCALL_64_after_hwframe+0x44/0xae
[   56.765185] RIP: 0033:0x404367
[   56.765587] Code: ff ff eb bb e8 1a 46 05 00 66 2e 0f 1f 84 00 00 00 00 00 f3 0f 1e fa 64 8b 04 25 18 00 00 00 85 c0 75 10 b8 2e 00 00 00 0f 05 <48> 3d 00 f0 ff ff 0
[   56.767987] RSP: 002b:00007ffe0e2b5ff8 EFLAGS: 00000246 ORIG_RAX: 000000000000002e
[   56.768987] RAX: ffffffffffffffda RBX: 0000000000400518 RCX: 0000000000404367
[   56.770106] RDX: 0000000000000000 RSI: 00007ffe0e2b6090 RDI: 0000000000000003
[   56.771057] RBP: 00007ffe0e2b6110 R08: 0000000001115be0 R09: 0000000000000022
[   56.772030] R10: 00000000004c6800 R11: 0000000000000246 R12: 00000000004056a0
[   56.773005] R13: 0000000000000000 R14: 00000000004c6018 R15: 0000000000000000
[   56.773921] 
[   56.774117] Allocated by task 1614:
[   56.774478]  kasan_save_stack+0x1b/0x40
[   56.774871]  __kasan_kmalloc+0x7c/0x90
[   56.775272]  nft_set_elem_init+0x6d/0xc0
[   56.775691]  nft_add_set_elem+0xc4f/0x15d0
[   56.776137]  nf_tables_newsetelem+0x372/0x410
[   56.776609]  nfnetlink_rcv_batch+0x7b9/0xad0
[   56.777080]  nfnetlink_rcv+0x1bb/0x1f0
[   56.777495]  netlink_unicast+0x2d8/0x3d0
[   56.777928]  netlink_sendmsg+0x398/0x680
[   56.778355]  sock_sendmsg+0x96/0xa0
[   56.778742]  ____sys_sendmsg+0x347/0x3e0
[   56.779167]  ___sys_sendmsg+0xe0/0x140
[   56.779572]  __sys_sendmsg+0xb3/0x130
[   56.779995]  do_syscall_64+0x3b/0x90
[   56.780364]  entry_SYSCALL_64_after_hwframe+0x44/0xae
[   56.780883] 
[   56.781075] The buggy address belongs to the object at ffff888006496480
[   56.781075]  which belongs to the cache kmalloc-64 of size 64
[   56.782418] The buggy address is located 48 bytes inside of
[   56.782418]  64-byte region [ffff888006496480, ffff8880064964c0)
[   56.783560] The buggy address belongs to the page:
[   56.784041] page:000000006969287d refcount:1 mapcount:0 mapping:0000000000000000 index:0x0 pfn:0x6496
[   56.784935] flags: 0x100000000000200(slab|node=0|zone=1)
[   56.785490] raw: 0100000000000200 ffffea000019f8c0 0000000700000002 ffff888005841640
[   56.786324] raw: 0000000000000000 0000000080200020 00000001ffffffff 0000000000000000
[   56.787101] page dumped because: kasan: bad access detected
[   56.787714] 
[   56.787913] Memory state around the buggy address:
[   56.788400]  ffff888006496380: 00 00 00 00 00 00 00 00 fc fc fc fc fc fc fc fc
[   56.789097]  ffff888006496400: 00 00 00 00 00 fc fc fc fc fc fc fc fc fc fc fc
[   56.789782] >ffff888006496480: 00 00 00 00 00 00 00 00 fc fc fc fc fc fc fc fc
[   56.790534]                                            ^
[   56.791024]  ffff888006496500: 00 00 00 00 00 00 00 00 fc fc fc fc fc fc fc fc
[   56.791727]  ffff888006496580: 00 00 00 00 00 00 00 00 fc fc fc fc fc fc fc fc
[   56.792396] ==================================================================