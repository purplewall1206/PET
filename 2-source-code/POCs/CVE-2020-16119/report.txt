[   15.576674] ==================================================================
[   15.577366] BUG: KASAN: use-after-free in ccid_hc_rx_delete+0x19/0x60
[   15.578002] Read of size 8 at addr ffff888009fdf000 by task poc/1133
[   15.578596] 
[   15.578750] CPU: 1 PID: 1133 Comm: poc Not tainted 5.15.0-detector-kasan #1
[   15.579399] Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.15.0-1 04/01/2014
[   15.580196] Call Trace:
[   15.580448]  dump_stack_lvl+0x34/0x44
[   15.580849]  print_address_description.constprop.0+0x21/0x140
[   15.581415]  ? ccid_hc_rx_delete+0x19/0x60
[   15.581815]  ? ccid_hc_rx_delete+0x19/0x60
[   15.582206]  kasan_report.cold+0x83/0xdf
[   15.582592]  ? ccid_hc_rx_delete+0x19/0x60
[   15.582978]  ccid_hc_rx_delete+0x19/0x60
[   15.583347]  dccp_destroy_sock+0x192/0x1c0
[   15.583732]  dccp_v6_destroy_sock+0xe/0x20
[   15.584123]  inet_csk_destroy_sock+0xb2/0x1f0
[   15.584572]  dccp_close+0x5ab/0x660
[   15.584939]  ? dccp_done+0x80/0x80
[   15.585289]  ? down_write+0xb2/0x100
[   15.585682]  ? __down_killable+0x210/0x210
[   15.586098]  inet_release+0x75/0xc0
[   15.586453]  __sock_release+0x72/0x120
[   15.586845]  sock_close+0x11/0x20
[   15.587182]  __fput+0x104/0x400
[   15.587502]  task_work_run+0x97/0xd0
[   15.587865]  exit_to_user_mode_prepare+0x14d/0x150
[   15.588360]  syscall_exit_to_user_mode+0x1d/0x40
[   15.588830]  do_syscall_64+0x48/0x90
[   15.589173]  entry_SYSCALL_64_after_hwframe+0x44/0xae
[   15.589649] RIP: 0033:0x7f109d1be6c3
[   15.589991] Code: e9 37 ff ff ff e8 4d e0 01 00 66 2e 0f 1f 84 00 00 00 00 00 0f 1f 00 64 8b 04 25 18 00 00 00 85 c0 75 14 b8 03 00 00 00 0f 05 <48> 3d 00 f0 ff ff 8
[   15.591735] RSP: 002b:00007ffc17e4ced8 EFLAGS: 00000246 ORIG_RAX: 0000000000000003
[   15.592458] RAX: 0000000000000000 RBX: 0000000000000000 RCX: 00007f109d1be6c3
[   15.593185] RDX: 0000000000000000 RSI: 000055d4e7ba32a0 RDI: 0000000000000004
[   15.593856] RBP: 00007ffc17e4cf60 R08: 000000000000000b R09: 00007f109d28dbe0
[   15.594535] R10: fffffffffffff28d R11: 0000000000000246 R12: 000055d4e7ad00e0
[   15.595204] R13: 0000000000000000 R14: 0000000000000000 R15: 0000000000000000
[   15.595894] 
[   15.596058] Allocated by task 1133:
[   15.596406]  kasan_save_stack+0x1b/0x40
[   15.596783]  __kasan_slab_alloc+0x61/0x80
[   15.597163]  kmem_cache_alloc+0xc3/0x1f0
[   15.597552]  ccid_new+0x98/0x1a0
[   15.597873]  dccp_hdlr_ccid+0x1d/0xa0
[   15.598220]  dccp_feat_activate_values+0x1a9/0x340
[   15.598666]  dccp_rcv_state_process+0x614/0x7b0
[   15.599098]  dccp_v6_do_rcv+0x108/0x400
[   15.599460]  __release_sock+0xd4/0x140
[   15.599826]  release_sock+0x39/0xd0
[   15.600162]  __inet_stream_connect+0x32c/0x5c0
[   15.600618]  inet_stream_connect+0x44/0x70
[   15.601026]  __sys_connect+0xeb/0x110
[   15.601400]  __x64_sys_connect+0x3e/0x50
[   15.601823]  do_syscall_64+0x3b/0x90
[   15.602184]  entry_SYSCALL_64_after_hwframe+0x44/0xae
[   15.602698] 
[   15.602862] Freed by task 1133:
[   15.603175]  kasan_save_stack+0x1b/0x40
[   15.603582]  kasan_set_track+0x1c/0x30
[   15.603940]  kasan_set_free_info+0x20/0x30
[   15.604475]  __kasan_slab_free+0xea/0x120
[   15.604945]  kmem_cache_free+0x77/0x280
[   15.605482]  dccp_hdlr_ccid+0x7c/0xa0
[   15.605995]  dccp_feat_activate_values+0x1a9/0x340
[   15.606631]  dccp_create_openreq_child+0x1ea/0x230
[   15.607130]  dccp_v6_request_recv_sock+0x131/0xa40
[   15.607653]  dccp_check_req+0x1b7/0x2f0
[   15.608051]  dccp_v6_rcv+0x31b/0xb30
[   15.608421]  ip6_protocol_deliver_rcu+0x6bc/0x820
[   15.608909]  ip6_input_finish+0x11/0x20
[   15.609283]  ip6_input+0x14b/0x160
[   15.609613]  ipv6_rcv+0x177/0x190
[   15.609938]  __netif_receive_skb_one_core+0xd9/0x130
[   15.610450]  process_backlog+0x10f/0x290
[   15.610853]  __napi_poll+0x5c/0x240
[   15.611192]  net_rx_action+0x47b/0x510
[   15.611557]  __do_softirq+0xf6/0x355
[   15.611922] 
[   15.612076] The buggy address belongs to the object at ffff888009fdf000
[   15.612076]  which belongs to the cache ccid2_hc_rx_sock of size 12
[   15.613533] The buggy address is located 0 bytes inside of
[   15.613533]  12-byte region [ffff888009fdf000, ffff888009fdf00c)
[   15.614891] The buggy address belongs to the page:
[   15.615554] page:00000000d37f0265 refcount:1 mapcount:0 mapping:0000000000000000 index:0x0 pfn:0x9fdf
[   15.616836] flags: 0x100000000000200(slab|node=0|zone=1)
[   15.617592] raw: 0100000000000200 0000000000000000 dead000000000122 ffff8880091e0dc0
[   15.618670] raw: 0000000000000000 0000000080550055 00000001ffffffff 0000000000000000
[   15.619725] page dumped because: kasan: bad access detected
[   15.620513] 
[   15.620731] Memory state around the buggy address:
[   15.621387]  ffff888009fdef00: fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc
[   15.622155]  ffff888009fdef80: fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc
[   15.622846] >ffff888009fdf000: fa fb fc fc fc fc fa fb fc fc fc fc 00 04 fc fc
[   15.623526]                    ^
[   15.623842]  ffff888009fdf080: fc fc fa fb fc fc fc fc fc fc fc fc fc fc fc fc
[   15.624550]  ffff888009fdf100: fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc
[   15.625363] ==================================================================
[   15.626109] Disabling lock debugging due to kernel taint
[   15.626746] ==================================================================
[   15.627547] BUG: KASAN: double-free or invalid-free in dccp_destroy_sock+0x192/0x1c0
[   15.628443] 
[   15.628687] CPU: 1 PID: 1133 Comm: poc Tainted: G    B             5.15.0-detector-kasan #1
[   15.629866] Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.15.0-1 04/01/2014
[   15.631011] Call Trace:
[   15.631352]  dump_stack_lvl+0x34/0x44
[   15.631866]  print_address_description.constprop.0+0x21/0x140
[   15.632743]  ? dccp_destroy_sock+0x192/0x1c0
[   15.633342]  kasan_report_invalid_free+0x51/0x80
[   15.633979]  ? dccp_destroy_sock+0x192/0x1c0
[   15.634569]  __kasan_slab_free+0x106/0x120
[   15.635143]  ? dccp_destroy_sock+0x192/0x1c0
[   15.635737]  kmem_cache_free+0x77/0x280
[   15.636273]  dccp_destroy_sock+0x192/0x1c0
[   15.636850]  dccp_v6_destroy_sock+0xe/0x20
[   15.637302]  inet_csk_destroy_sock+0xb2/0x1f0
[   15.637901]  dccp_close+0x5ab/0x660
[   15.638411]  ? dccp_done+0x80/0x80
[   15.638877]  ? down_write+0xb2/0x100
[   15.639339]  ? __down_killable+0x210/0x210
[   15.639771]  inet_release+0x75/0xc0
[   15.640153]  __sock_release+0x72/0x120
[   15.640583]  sock_close+0x11/0x20
[   15.640980]  __fput+0x104/0x400
[   15.641380]  task_work_run+0x97/0xd0
[   15.641876]  exit_to_user_mode_prepare+0x14d/0x150
[   15.642480]  syscall_exit_to_user_mode+0x1d/0x40
[   15.643012]  do_syscall_64+0x48/0x90
[   15.643420]  entry_SYSCALL_64_after_hwframe+0x44/0xae
[   15.644135] RIP: 0033:0x7f109d1be6c3
[   15.644626] Code: e9 37 ff ff ff e8 4d e0 01 00 66 2e 0f 1f 84 00 00 00 00 00 0f 1f 00 64 8b 04 25 18 00 00 00 85 c0 75 14 b8 03 00 00 00 0f 05 <48> 3d 00 f0 ff ff 8
[   15.647224] RSP: 002b:00007ffc17e4ced8 EFLAGS: 00000246 ORIG_RAX: 0000000000000003
[   15.648247] RAX: 0000000000000000 RBX: 0000000000000000 RCX: 00007f109d1be6c3
[   15.649270] RDX: 0000000000000000 RSI: 000055d4e7ba32a0 RDI: 0000000000000004
[   15.650281] RBP: 00007ffc17e4cf60 R08: 000000000000000b R09: 00007f109d28dbe0
[   15.651275] R10: fffffffffffff28d R11: 0000000000000246 R12: 000055d4e7ad00e0
[   15.652290] R13: 0000000000000000 R14: 0000000000000000 R15: 0000000000000000
[   15.653326] 
[   15.653560] Allocated by task 1133:
[   15.654076]  kasan_save_stack+0x1b/0x40
[   15.654619]  __kasan_slab_alloc+0x61/0x80
[   15.655181]  kmem_cache_alloc+0xc3/0x1f0
[   15.655760]  ccid_new+0x98/0x1a0
[   15.656217]  dccp_hdlr_ccid+0x1d/0xa0
[   15.656748]  dccp_feat_activate_values+0x1a9/0x340
[   15.657410]  dccp_rcv_state_process+0x614/0x7b0
[   15.658034]  dccp_v6_do_rcv+0x108/0x400
[   15.658560]  __release_sock+0xd4/0x140
[   15.659070]  release_sock+0x39/0xd0
[   15.659573]  __inet_stream_connect+0x32c/0x5c0
[   15.660195]  inet_stream_connect+0x44/0x70
[   15.660784]  __sys_connect+0xeb/0x110
[   15.661305]  __x64_sys_connect+0x3e/0x50
[   15.661861]  do_syscall_64+0x3b/0x90
[   15.662353]  entry_SYSCALL_64_after_hwframe+0x44/0xae
[   15.662990] 
[   15.663148] Freed by task 1133:
[   15.663477]  kasan_save_stack+0x1b/0x40
[   15.663922]  kasan_set_track+0x1c/0x30
[   15.664348]  kasan_set_free_info+0x20/0x30
[   15.664820]  __kasan_slab_free+0xea/0x120
[   15.665267]  kmem_cache_free+0x77/0x280
[   15.665697]  dccp_hdlr_ccid+0x7c/0xa0
[   15.666115]  dccp_feat_activate_values+0x1a9/0x340
[   15.666729]  dccp_create_openreq_child+0x1ea/0x230
[   15.667429]  dccp_v6_request_recv_sock+0x131/0xa40
[   15.668112]  dccp_check_req+0x1b7/0x2f0
[   15.668680]  dccp_v6_rcv+0x31b/0xb30
[   15.669191]  ip6_protocol_deliver_rcu+0x6bc/0x820
[   15.669893]  ip6_input_finish+0x11/0x20
[   15.670470]  ip6_input+0x14b/0x160
[   15.670939]  ipv6_rcv+0x177/0x190
[   15.671297]  __netif_receive_skb_one_core+0xd9/0x130
[   15.671826]  process_backlog+0x10f/0x290
[   15.672242]  __napi_poll+0x5c/0x240
[   15.672633]  net_rx_action+0x47b/0x510
[   15.673032]  __do_softirq+0xf6/0x355
[   15.673425] 
[   15.673596] The buggy address belongs to the object at ffff888009fdf000
[   15.673596]  which belongs to the cache ccid2_hc_rx_sock of size 12
[   15.674925] The buggy address is located 0 bytes inside of
[   15.674925]  12-byte region [ffff888009fdf000, ffff888009fdf00c)
[   15.676101] The buggy address belongs to the page:
[   15.676692] page:00000000d37f0265 refcount:1 mapcount:0 mapping:0000000000000000 index:0x0 pfn:0x9fdf
[   15.677933] flags: 0x100000000000200(slab|node=0|zone=1)
[   15.678758] raw: 0100000000000200 0000000000000000 dead000000000122 ffff8880091e0dc0
[   15.679889] raw: 0000000000000000 0000000080550055 00000001ffffffff 0000000000000000
[   15.681026] page dumped because: kasan: bad access detected
[   15.681857] 
[   15.682096] Memory state around the buggy address:
[   15.682805]  ffff888009fdef00: fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc
[   15.683900]  ffff888009fdef80: fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc
[   15.684847] >ffff888009fdf000: fa fb fc fc fc fc fa fb fc fc fc fc 00 04 fc fc
[   15.685594]                    ^
[   15.685989]  ffff888009fdf080: fc fc fa fb fc fc fc fc fc fc fc fc fc fc fc fc
[   15.686794]  ffff888009fdf100: fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc
[   15.687604] ==================================================================