[   24.623990] BUG: KASAN: slab-out-of-bounds in xfrm_replay_advance+0x448/0x510
[   24.624691] Write of size 4 at addr ffff8880080bd880 by task poc_cfh_baselin/1164
[   24.625668] 
[   24.625898] CPU: 1 PID: 1164 Comm: poc_cfh_baselin Not tainted 5.15.0-detector-kasan #1
[   24.627001] Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.15.0-1 04/01/2014
[   24.628211] Call Trace:
[   24.628558]  <IRQ>
[   24.628822]  dump_stack_lvl+0x34/0x44
[   24.629314]  print_address_description.constprop.0+0x21/0x140
[   24.630108]  ? xfrm_replay_advance+0x448/0x510
[   24.630712]  ? xfrm_replay_advance+0x448/0x510
[   24.631275]  kasan_report.cold+0x83/0xdf
[   24.631731]  ? xfrm_replay_advance+0x448/0x510
[   24.632240]  xfrm_replay_advance+0x448/0x510
[   24.632712]  xfrm_input+0x8c2/0x2410
[   24.633174]  ? raw_rcv_skb+0x1e/0x40
[   24.633564]  ? raw_rcv+0x12c/0x1c0
[   24.633893]  ? xfrm_parse_spi+0x200/0x200
[   24.634340]  ? raw_rcv+0x1c0/0x1c0
[   24.634682]  ? autoremove_wake_function+0x6b/0x80
[   24.635182]  xfrm4_ah_rcv+0x4e/0x80
[   24.635536]  ip_protocol_deliver_rcu+0x2c5/0x2d0
[   24.636005]  ip_local_deliver_finish+0xae/0xc0
[   24.636469]  ip_local_deliver+0xfe/0x1e0
[   24.636857]  ? ip_local_deliver_finish+0xc0/0xc0
[   24.637362]  ? __netif_receive_skb_core+0x2b3/0x1770
[   24.637916]  ? ip_rcv_finish_core.isra.0+0x170/0x8a0
[   24.638474]  ip_rcv+0x161/0x170
[   24.638831]  ? ip_sublist_rcv+0x310/0x310
[   24.639250]  ? update_load_avg+0x5a6/0xb20
[   24.639752]  ? __cgroup_account_cputime+0x46/0x50
[   24.640260]  ? ip_sublist_rcv+0x310/0x310
[   24.640692]  __netif_receive_skb_one_core+0x11f/0x130
[   24.641239]  ? __netif_receive_skb_core+0x1770/0x1770
[   24.641786]  ? _raw_spin_lock+0x7a/0xd0
[   24.642257]  ? _raw_read_lock_irq+0x30/0x30
[   24.642784]  ? posix_cpu_timers_exit_group+0x30/0x30
[   24.643558]  process_backlog+0x10f/0x290
[   24.644004]  __napi_poll+0x5c/0x240
[   24.644387]  net_rx_action+0x47b/0x510
[   24.644809]  ? napi_threaded_poll+0x260/0x260
[   24.645298]  ? __hrtimer_next_event_base+0x8c/0x130
[   24.645860]  ? dmar_free_hwirq+0x10/0x10
[   24.646313]  ? lapic_next_event+0x36/0x40
[   24.646838]  ? clockevents_program_event+0xd8/0x130
[   24.647402]  ? hrtimer_interrupt+0x326/0x340
[   24.647864]  __do_softirq+0xf6/0x355
[   24.648257]  do_softirq+0x53/0x70
[   24.648648]  </IRQ>
[   24.648886]  __local_bh_enable_ip+0x4b/0x50
[   24.649338]  ip_finish_output2+0x34f/0x9d0
[   24.649795]  ? _raw_spin_lock_irqsave+0x80/0xe0
[   24.650317]  ? _raw_write_lock_irqsave+0xe0/0xe0
[   24.650967]  ? _raw_write_lock_irqsave+0xe0/0xe0
[   24.651592]  ? ip_setup_cork+0x360/0x360
[   24.652027]  __ip_finish_output+0x40e/0x550
[   24.652494]  ? ip_fragment.constprop.0+0xf0/0xf0
[   24.653017]  ? apparmor_ip_postroute.isra.0+0x18/0xb0
[   24.653596]  ? nf_hook_slow+0x99/0xd0
[   24.654007]  ip_output+0x113/0x1e0
[   24.654389]  ? ip_finish_output+0x10/0x10
[   24.654867]  ? __ip_select_ident+0x8a/0xb0
[   24.655398]  ? __ip_finish_output+0x550/0x550
[   24.655879]  ip_send_skb+0x27/0x70
[   24.656268]  raw_sendmsg+0x95b/0x1380
[   24.656727]  ? kasan_unpoison+0x23/0x50
[   24.657155]  ? __kasan_slab_alloc+0x10/0x80
[   24.657591]  ? raw_setsockopt+0xb0/0xb0
[   24.657992]  ? skb_release_data+0x20b/0x210
[   24.658441]  ? kasan_set_track+0x1c/0x30
[   24.658867]  ? netlink_unicast+0x2e0/0x3d0
[   24.659300]  ? kmem_cache_free+0x77/0x280
[   24.659712]  ? netlink_unicast+0x2fc/0x3d0
[   24.660133]  ? aa_sk_perm+0x128/0x350
[   24.660532]  ? aa_af_perm+0x1e0/0x1e0
[   24.660934]  ? iovec_from_user+0x12e/0x1a0
[   24.661372]  ? inet_send_prepare+0x1b/0x100
[   24.661840]  ? inet_send_prepare+0x100/0x100
[   24.662284]  ? sock_sendmsg+0x8f/0xa0
[   24.662736]  sock_sendmsg+0x8f/0xa0
[   24.663110]  ____sys_sendmsg+0x347/0x3e0
[   24.663524]  ? kernel_sendmsg+0x30/0x30
[   24.663933]  ? __copy_msghdr_from_user+0x250/0x250
[   24.664484]  ? _raw_spin_unlock_irqrestore+0x12/0x30
[   24.665026]  ? __wake_up_common+0x230/0x230
[   24.665463]  ? mutex_trylock+0xc5/0x140
[   24.665934]  ___sys_sendmsg+0xe0/0x140
[   24.666384]  ? sendmsg_copy_msghdr+0x30/0x30
[   24.666839]  ? ldsem_up_read+0x13/0x40
[   24.667262]  ? file_tty_write.isra.0+0x32c/0x440
[   24.667760]  ? new_sync_write+0x276/0x370
[   24.668192]  ? __fsnotify_parent+0x3d1/0x4e0
[   24.668666]  ? __fsnotify_update_child_dentry_flags+0x1a0/0x1a0
[   24.669329]  ? apparmor_task_setrlimit+0x2a0/0x2a0
[   24.669909]  ? kmem_cache_free+0x77/0x280
[   24.670413]  ? __fget_light+0x9e/0xf0
[   24.670838]  __sys_sendmsg+0xb3/0x130
[   24.671291]  ? __sys_sendmsg_sock+0x20/0x20
[   24.671775]  ? ksys_write+0x1/0x150
[   24.672165]  ? fpregs_assert_state_consistent+0x52/0x60
[   24.672778]  ? exit_to_user_mode_prepare+0x35/0x150
[   24.673327]  do_syscall_64+0x3b/0x90
[   24.673831]  entry_SYSCALL_64_after_hwframe+0x44/0xae
[   24.674407] RIP: 0033:0x7fdf76fa1e13
[   24.674835] Code: 8b 15 b9 91 00 00 f7 d8 64 89 02 48 c7 c0 ff ff ff ff eb b8 0f 1f 00 64 8b 04 25 18 00 00 00 85 c0 75 14 b8 2e 00 00 00 0f 05 <48> 3d 00 f0 ff ff 8
[   24.675932] RSP: 002b:00007ffe7ff28188 EFLAGS: 00000246 ORIG_RAX: 000000000000002e
[   24.676403] RAX: ffffffffffffffda RBX: 0000000000000000 RCX: 00007fdf76fa1e13
[   24.676838] RDX: 0000000000000000 RSI: 00007ffe7ff281c0 RDI: 0000000000000007
[   24.677296] RBP: 00007ffe7ff29240 R08: 0000000000000001 R09: 0000000000000000
[   24.677671] R10: 00007fdf76f3aac0 R11: 0000000000000246 R12: 000055c4c08ea960
[   24.678033] R13: 0000000000000000 R14: 0000000000000000 R15: 0000000000000000
[   24.678424] 
[   24.678529] Allocated by task 1164:
[   24.678717]  kasan_save_stack+0x1b/0x40
[   24.678954]  __kasan_kmalloc+0x7c/0x90
[   24.679167]  xfrm_add_sa+0xedd/0x15c0
[   24.679378]  xfrm_user_rcv_msg+0x213/0x4a0
[   24.679612]  netlink_rcv_skb+0x15c/0x1f0
[   24.679835]  xfrm_netlink_rcv+0x45/0x50
[   24.680052]  netlink_unicast+0x2d8/0x3d0
[   24.680276]  netlink_sendmsg+0x398/0x680
[   24.680498]  sock_sendmsg+0x96/0xa0
[   24.680700]  ____sys_sendmsg+0x347/0x3e0
[   24.680925]  ___sys_sendmsg+0xe0/0x140
[   24.681140]  __sys_sendmsg+0xb3/0x130
[   24.681395]  do_syscall_64+0x3b/0x90
[   24.681619]  entry_SYSCALL_64_after_hwframe+0x44/0xae
[   24.681939] 
[   24.682045] The buggy address belongs to the object at ffff8880080bd800
[   24.682045]  which belongs to the cache kmalloc-128 of size 128
[   24.682854] The buggy address is located 0 bytes to the right of
[   24.682854]  128-byte region [ffff8880080bd800, ffff8880080bd880)
[   24.683600] The buggy address belongs to the page:
[   24.683916] page:000000003973301d refcount:1 mapcount:0 mapping:0000000000000000 index:0x0 pfn:0x80bd
[   24.684491] flags: 0x100000000000200(slab|node=0|zone=1)
[   24.684820] raw: 0100000000000200 ffffea0000246ec0 0000000200000002 ffff8880058418c0
[   24.685287] raw: 0000000000000000 0000000080100010 00000001ffffffff 0000000000000000
[   24.685775] page dumped because: kasan: bad access detected
[   24.686117] 
[   24.686213] Memory state around the buggy address:
[   24.686506]  ffff8880080bd780: fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc
[   24.686961]  ffff8880080bd800: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
[   24.687398] >ffff8880080bd880: fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc
[   24.687982]                    ^
[   24.688232]  ffff8880080bd900: fa fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
[   24.688755]  ffff8880080bd980: fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc
[   24.689290] ==================================================================
[   24.689810] Disabling lock debugging due to kernel taint