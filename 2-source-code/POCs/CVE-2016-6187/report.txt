[   40.661480] ==================================================================
[   40.663185] BUG: KASAN: slab-out-of-bounds in apparmor_setprocattr+0x116/0x590
[   40.664938] Write of size 1 at addr ffff888007449c80 by task poc_cfh_baselin/1140

[   40.667110] CPU: 1 PID: 1140 Comm: poc_cfh_baselin Not tainted 5.15.0-detector-kasan #1
[   40.668071] Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.15.0-1 04/01/2014
[   40.668938] Call Trace:
[   40.669224]  dump_stack_lvl+0x34/0x44
[   40.669630]  print_address_description.constprop.0+0x21/0x140
[   40.670284]  ? apparmor_setprocattr+0x116/0x590
[   40.670754]  ? apparmor_setprocattr+0x116/0x590
[   40.671215]  kasan_report.cold+0x83/0xdf
[   40.671669]  ? apparmor_setprocattr+0x116/0x590
[   40.672164]  apparmor_setprocattr+0x116/0x590
[   40.672622]  ? apparmor_socket_create+0x300/0x300
[   40.673144]  ? simple_attr_release+0x30/0x30
[   40.673598]  ? __mutex_lock_interruptible_slowpath+0x10/0x10
[   40.674195]  ? _copy_from_user+0x38/0x70
[   40.674617]  proc_pid_attr_write+0x15f/0x1e0
[   40.675075]  vfs_write+0xfc/0x390
[   40.675444]  ksys_write+0xb9/0x150
[   40.675803]  ? __ia32_sys_read+0x50/0x50
[   40.676218]  ? fpregs_assert_state_consistent+0x52/0x60
[   40.676768]  ? exit_to_user_mode_prepare+0x35/0x150
[   40.677251]  do_syscall_64+0x3b/0x90
[   40.677604]  entry_SYSCALL_64_after_hwframe+0x44/0xae
[   40.678093] RIP: 0033:0x7f4fd6646fb3
[   40.678447] Code: 75 05 48 83 c4 58 c3 e8 cb 41 ff ff 66 2e 0f 1f 84 00 00 00 00 00 90 64 8b 04 25 18 00 00 00 85 c0 75 14 b8 01 00 00 00 0f 05 <48> 3d 00 f0 ff ff 8
[   40.680223] RSP: 002b:00007ffe18d48ca8 EFLAGS: 00000246 ORIG_RAX: 0000000000000001
[   40.680960] RAX: ffffffffffffffda RBX: 0000000000000000 RCX: 00007f4fd6646fb3
[   40.681641] RDX: 0000000000000080 RSI: 00007ffe18d48cd0 RDI: 0000000000000005
[   40.682341] RBP: 00007ffe18d48d60 R08: 0000000000000000 R09: 0000000000000001
[   40.683070] R10: 0000000000000000 R11: 0000000000000246 R12: 0000555843552840
[   40.683774] R13: 0000000000000000 R14: 0000000000000000 R15: 0000000000000000

[   40.684604] Allocated by task 408:
[   40.684953]  kasan_save_stack+0x1b/0x40
[   40.685380]  __kasan_kmalloc+0x7c/0x90
[   40.685787]  ext4_htree_store_dirent+0x56/0x200
[   40.686291]  htree_dirblock_to_tree+0x378/0x530
[   40.686787]  ext4_htree_fill_tree+0x393/0x510
[   40.687247]  ext4_readdir+0x382/0x12c0
[   40.687659]  iterate_dir+0x101/0x2d0
[   40.688060]  __x64_sys_getdents64+0xf3/0x1c0
[   40.688511]  do_syscall_64+0x3b/0x90
[   40.688902]  entry_SYSCALL_64_after_hwframe+0x44/0xae

[   40.689587] The buggy address belongs to the object at ffff888007449c00
                which belongs to the cache kmalloc-128 of size 128
[   40.690866] The buggy address is located 0 bytes to the right of
                128-byte region [ffff888007449c00, ffff888007449c80)
[   40.692081] The buggy address belongs to the page:
[   40.692587] page:00000000474f2860 refcount:1 mapcount:0 mapping:0000000000000000 index:0x0 pfn:0x7449
[   40.693588] flags: 0x100000000000200(slab|node=0|zone=1)
[   40.694164] raw: 0100000000000200 ffffea0000243680 0000000800000008 ffff8880058418c0
[   40.694997] raw: 0000000000000000 0000000080100010 00000001ffffffff 0000000000000000
[   40.695831] page dumped because: kasan: bad access detected

[   40.696621] Memory state around the buggy address:
[   40.697131]  ffff888007449b80: fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc
[   40.697914]  ffff888007449c00: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
[   40.698789] >ffff888007449c80: fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc
[   40.699883]                    ^
[   40.700390]  ffff888007449d00: fa fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
[   40.701447]  ffff888007449d80: fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc
[   40.702609] ==================================================================
[   40.703692] Disabling lock debugging due to kernel taint